<!--邮箱验证弹窗-->
{if $user_info['login_type'] eq "mobile"}
<div class="hyq-modal hyq-modal-default RdBorderTop" id="valid-email-modal" role="dialog">

	<div class="hyq-modal-header GrayBorderBtm txt-left">
		<label class="f16 pull-left Gray8">&nbsp;&nbsp;邮箱验证</label>
		<a class="hyq-modal-close-btn" href="javascript:void(null)"></a>
	</div>
	<div class='gray-spliter _clb'></div>
	<div class="hyq-model-body _clb field-fix-width">

		<br/>
		<br/>
		<div class="form-group-centered field-fix-width-1">
			<input type="text" name="name" placeholder="请输入您的邮箱地址" id="certify_email_account" class="field-fix-width-1 _clb" />
			<div class="hyq-f-err txt-left" id="certify_email_format_tips" style="display:none">
				<i class="hyq-ic ic-vlid-err"></i>
				<label>错误信息 </label>
			</div>
		</div>

		<div>
			<a type="button" class="hyq-btn hyq-btn-lg" onclick="mobile_user_certify_email()">&nbsp; 点击验证 &nbsp;</a>
		</div>
	</div>
	<div class="hyq-model-bottom">

	</div>
</div>
{else}
<div class="hyq-modal hyq-modal-default RdBorderTop" id="valid-email-modal" role="dialog">

	<div class="email-check-wrap bgGray2 RdBorderTop">
      <p class="check-title">
          <span >邮箱验证</span>
          <a class="hyq-modal-close-btn" href="javascript:void(null)"></a>
      </p>    
      <div class="cl"></div>
      <p class="p-center">
          <label>点击确认发送到当前账号：<span>{$user_info['email']}</span></label><br>
          <label>进行邮箱验证</label><br>
          <input type="button" class="hyq-btn hyq-btn-lg " value="确认发送" onclick="email_user_certify_email()">
      <p>

    </div>
	<!-- tips 框 -->
	<div class="hyq-tip" id="tip-message" >
		<i hyq-tip-icon-node></i>
		<label class="hyq-tip-msg-node"></label>
	</div>		
	<div class="hyq-model-bottom">

	</div>
</div>
{/if}
<!--邮箱验证弹窗结束-->

<!--身份证验证弹窗-->
<div class="hyq-modal hyq-modal-default RdBorderTop" id="valid-idcard-modal" role="dialog">

	<div class="hyq-modal-header GrayBorderBtm txt-left">
		<label class="f16 pull-left Gray8">&nbsp;&nbsp;身份证验证</label>
		<a class="hyq-modal-close-btn" href="javascript:void(null)"></a>
	</div>
	<div class='gray-spliter _clb'></div>
	<div class="hyq-model-body _clb field-fix-width" >

		<br/>

		<div class="form-group-centered field-fix-width-1">
			<input type="text" name="name" placeholder="请输入您身份证的名字" onkeyup="value=value.replace(/[^\u4E00-\u9FA5·A-Za-z]/g,'')" id="identity_name" class="field-fix-width-1 _clb" />
			<div class="hyq-f-err txt-left" id="identity_name_format_tips" style="display:none">
				<i class="hyq-ic ic-vlid-err"></i>
				<label>错误信息 </label>
			</div>
		</div>

		<div class="form-group-centered field-fix-width-1">

			<input type="text" name="idcard" placeholder="请输入您的身份证号" onkeyup="value=value.replace(/[^0-9xX]/g,'')"  id="identity_num" class="field-fix-width-1 _clb" />
			<div class="hyq-f-err txt-left" id="identity_num_format_tips" style="display:none">
				<i class="hyq-ic ic-vlid-err"></i>
				<label>错误信息 </label>
			</div>

		</div>

		<div>
			<a type="button" class="hyq-btn hyq-btn-lg" onclick="certify_identity_card()">&nbsp; 提交 &nbsp;</a>
		</div>
	</div>
	<div class="hyq-model-bottom">

	</div>
</div>
<!--身份证验证弹窗结束-->

<!--手机验证弹窗-->
<div class="hyq-modal hyq-modal-default RdBorderTop" id="valid-mobile-modal" role="dialog">

	<div class="hyq-modal-header GrayBorderBtm txt-left">
		<label class="f16 pull-left Gray8">&nbsp;&nbsp;手机验证</label>
		<a class="hyq-modal-close-btn" href="javascript:void(null)"></a>
	</div>
	<div class='gray-spliter _clb'></div>
	<div class="hyq-model-body _clb field-fix-width" >

		<br/>

		<div class="form-group field-fix-width-2 txt-left">
			<div class="field-fix-width-2" style='margin-left:50px;'>
				<input type="text" name="name" placeholder="请输入11位手机号" onkeyup="this.value=this.value.replace(/\D/g,'')" id="certify_mobile_account" >
				<input type="button" class="hyq-btn hyq-btn-dark" id="get_certify_mobile_btn" onclick="get_certify_mobile_code()" value="获取短信验证码" />
			</div>
			<div class="hyq-f-err txt-left" style='margin-left:50px;display:none;' id="certify_mobile_format_tips">
				<i class="hyq-ic ic-vlid-err"></i>
				<label>错误信息 </label>
			</div>
		</div>

		<div class="form-group field-fix-width-2 txt-left">
			<div class="field-fix-width-2 field-fix-margin-1" style='margin-left:50px;'>
				<input type="text" name="name" placeholder="请输入短信验证码" onkeyup="this.value=this.value.replace(/\D/g,'')" id="certify_mobile_code">
				<input type="button" class="hyq-btn hyq-btn-dark" onclick="email_user_certify_mobile()" value="&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;点击验证&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" />
			</div>
			<div class="hyq-f-err txt-left" style='margin-left:50px;display:none;' id="certify_mobile_code_tips">
				<i class="hyq-ic ic-vlid-err"></i>
				<label>错误信息</label>
			</div>
		</div>
 
	</div>
	<div class="hyq-model-bottom">

	</div>
</div>
<!--手机验证弹窗结束-->
{literal}
<script type="text/javascript" charset="utf-8">
	/*邮箱用户发送邮件*/
	function email_user_certify_email(){
		$.post("/home/ajax/ajax_home_account.php",{'action':'email_user_certify_email'},function(data){
			if(parseInt(data) == 1000){
				var tip = $("#tip-message").HYQTip();
				tip.showSuccess("邮件发送成功");					
			}else{
				var tip = $("#tip-message").HYQTip();
				tip.showSuccess("邮件发送失败");	
			}

		},'text');	
	}			

	/*----------------手机用户认证邮箱-----------------*/
	$("#certify_email_account").focus(function(){
		$("#certify_email_format_tips").fadeOut();
		if($(this).val() == this.defaultValue){
			$(this).val("");
		}
	})
	.blur(
		function(){
			if($(this).val() == ''){
				$(this).val(this.defaultValue);
				$("#certify_email_format_tips").fadeOut();
				return;
			}else{
				var email_pattern = new RegExp(/^[a-zA-Z0-9_+.-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,4}$/);
				if(email_pattern.test($(this).val())){
					$("#certify_email_format_tips").fadeOut();
				}else{
					$("#certify_email_format_tips label").text('请输入正确邮箱地址!');
					$("#certify_email_format_tips").fadeIn();
					return;
				}
			}
		}
	);
	function mobile_user_certify_email(){
		$("#certify_email_account").blur();
		$.post("/home/ajax/ajax_home_account.php",{'action':'mobile_user_certify_email','email':$("#certify_email_account").val()},function(data){
			if(parseInt(data) == 1000){
				$("#certify_email_format_tips").fadeOut();
				$('#valid-email-modal').trigger("hyq/modal/close");
			}else{
				$("#certify_email_format_tips label").text(state_list[parseInt(data)]);
				$("#certify_email_format_tips").fadeIn();
				return;
			}
		},'text');
	}
	/*----------------身份证认证-----------------*/
	$('#identity_name').focus(function(){
		$("#identity_name_format_tips").fadeOut();
		if($(this).val() == this.defaultValue){
			$(this).val("");
		}
	})
	.blur(
		function(){
			if($(this).val() == ''){
				$(this).val(this.defaultValue);
				$("#identity_name_format_tips").fadeOut();
				return;
			}
		}
	);
	$('#identity_num').focus(function(){
		$("#identity_num_format_tips").fadeOut();
		if($(this).val() == this.defaultValue){
			$(this).val("");
		}
	})
	.blur(
		function(){
			if($(this).val() == ''){
				$(this).val(this.defaultValue);
				$("#identity_num_format_tips").fadeOut();
				return;
			}else{
				var pattern_one = new RegExp(/^\d{6}((0[48]|[2468][048]|[13579][26])0229|\d\d(0[13578]|10|12)(3[01]|[12]\d|0[1-9])|(0[469]|11)(30|[12]\d|0[1-9])|(02)(2[0-8]|1\d|0[1-9]))\d{3}$/);
				var pattern_two = new RegExp( /^\d{6}((2000|(19|21)(0[48]|[2468][048]|[13579][26]))0229|(((20|19)\d\d)|2100)((0[13578]|10|12)(3[01]|[12]\d|0[1-9])|(0[469]|11)(30|[12]\d|0[1-9])|(02)(2[0-8]|1\d|0[1-9])))\d{3}[\dX]$/);	
				if(pattern_one.test($(this).val()) || pattern_two.test($(this).val())){
					$("#identity_num_format_tips").fadeOut();
				}else{
					$("#identity_num_format_tips label").text('请输入正确的身份证号!');
					$("#identity_num_format_tips").fadeIn();
					return;
				}
			}
		}
	);
	function certify_identity_card(){
		$('#identity_name').blur();
		$('#identity_num').blur();
		$.post("/home/ajax/ajax_home_account.php",{'action':'certify_identity_card','identity_name':$("#identity_name").val(),'identity_num':$("#identity_num").val()},function(data){
			alert(data);
			if(parseInt(data) == 1000){
				$("#identity_num_format_tips").fadeOut();
				$('#valid-idcard-modal').trigger("hyq/modal/close");
				$('#certify_identity_gray_icon_edit').hide();
				$('#certify_identity_gray_icon').hide();
				$('#certify_identity_red_icon_edit').show();
				$('#certify_identity_red_icon').show();
			}else{
				$("#identity_num_format_tips label").text(state_list[parseInt(data)]);
				$("#identity_num_format_tips").fadeIn();
				return;
			}
		},'text');
	}
	/*----------------邮箱用户认证手机号-----------------*/
	$("#certify_mobile_account").focus(function(){
		$("#certify_mobile_format_tips").fadeOut();
		$("#certify_mobile_code_tips").fadeOut();
		if($(this).val() == this.defaultValue){
			$(this).val("");
		}
	})
	.blur(
		function(){
			if($(this).val() == ''){
				$(this).val(this.defaultValue);
				$("#certify_mobile_format_tips").fadeOut();
				return;
			}else{
				var mobile_pattern = new RegExp(/^1[3578]\d{9}$/);
				if(mobile_pattern.test($(this).val())){
					$("#certify_mobile_format_tips").fadeOut();
				}else{
					$("#certify_mobile_format_tips label").text('请输入正确手机账号!');
					$("#certify_mobile_format_tips").fadeIn();
					return;
				}
			}
		}
	);
	
	var ss = 300;
	function count_down(){
		if(ss == 0){
			clearInterval();//停止计时器
			$("#get_certify_mobile_btn").removeAttr("disabled");//启用按钮
			$("#get_certify_mobile_btn").val("获取短信验证码");
		}else{
			ss--;
			$("#get_certify_mobile_btn").prop("value",ss + "秒后重发");
		}
	}
	//获取手机验证码
	function get_certify_mobile_code(){
		$("#certify_mobile_account").blur();
		$.post("/home/ajax/ajax_home_account.php",{'action':'get_certify_mobile_code','mobile':$("#certify_mobile_account").val()},function(data){
			if(parseInt(data) == 1000){
				$("#certify_mobile_format_tips").fadeOut();
				//换成倒计时
				$('#get_certify_mobile_btn').prop("disabled", "true");
				ss = 300;
				setInterval(count_down,1000); 
			}else{
				$("#certify_mobile_format_tips label").text(state_list[parseInt(data)]);
				$("#certify_mobile_format_tips").fadeIn();
				return;
			}
		},'text');
	}
	$("#certify_mobile_code").focus(function(){
		$("#certify_mobile_code_tips").fadeOut();
		if($(this).val() == this.defaultValue){
			$(this).val("");
		}
	})
	.blur(
		function(){
			if($(this).val() == ''){
				$(this).val(this.defaultValue);
				$("#certify_mobile_code_tips").fadeOut();
				return;
			}else{
				if($(this).val().length == 6 && !isNaN($(this).val())){
					$("#certify_mobile_code_tips").fadeOut();
				}else{
					$("#certify_mobile_code_tips label").text('请输入正确的验证码!');
					$("#certify_mobile_code_tips").fadeIn();
					return;
				}
			}
		}
	);
	function email_user_certify_mobile(){
		$("#certify_mobile_code").blur();
		$.post("/home/ajax/ajax_home_account.php",{'action':'email_user_certify_mobile','mobile':$("#certify_mobile_account").val(),'check_code':$("#certify_mobile_code").val()},function(data){
			if(parseInt(data) == 1000){
				$("#certify_mobile_code_tips").fadeOut();
				$('#valid-mobile-modal').trigger("hyq/modal/close");
				$('#certify_mobile_gray_icon_edit').hide();
				$('#certify_mobile_gray_icon').hide();
				$('#certify_mobile_red_icon_edit').show();
				$('#certify_mobile_red_icon').show();
			}else{
				$("#certify_mobile_code_tips label").text(state_list[parseInt(data)]);
				$("#certify_mobile_code_tips").fadeIn();
				return;
			}
		},'text');
	}
</script>
{/literal}